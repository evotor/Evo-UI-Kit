<div class="evo-autocomplete" [evoUiClass]="classes">
    <ng-select
        [items]="items"
        [bindLabel]="bindLabel"
        [bindValue]="bindValue"
        [markFirst]="markFirst"
        [placeholder]="placeholder"
        [notFoundText]="notFoundText"
        [typeToSearchText]="typeToSearchText"
        [addTagText]="addTagText"
        [loadingText]="loadingText"
        [clearAllText]="clearAllText"
        [dropdownPosition]="dropdownPosition"
        [appendTo]="appendTo"
        [loading]="loading"
        [closeOnSelect]="closeOnSelect"
        [hideSelected]="hideSelected"
        [selectOnTab]="selectOnTab"
        [openOnEnter]="openOnEnter"
        [maxSelectedItems]="maxSelectedItems"
        [groupBy]="groupBy"
        [groupValue]="groupValue"
        [bufferAmount]="bufferAmount"
        [virtualScroll]="virtualScroll"
        [selectableGroup]="selectableGroup"
        [selectableGroupAsModel]="selectableGroupAsModel"
        [searchFn]="searchFn"
        [clearOnBackspace]="clearOnBackspace"
        [typeahead]="typeahead"
        [multiple]="multiple || multipleInline"
        [addTag]="addTag"
        [searchable]="searchable"
        [clearable]="clearable"
        [isOpen]="isOpen"
        [editableSearchTerm]="editQuery"
        [disabled]="control.disabled"
        [compareWith]="compareWith"
        [(ngModel)]="value"
        (blur)="onBlur($event)"
        (focus)="onFocus($event)"
        (change)="changeEvent.emit($event)"
        (open)="openEvent.emit($event)"
        (close)="closeEvent.emit($event)"
        (search)="searchEvent.emit($event)"
        (clear)="clearEvent.emit($event)"
        (add)="addEvent.emit($event)"
        (remove)="removeEvent.emit($event)"
        (scroll)="scrollEvent.emit($event)"
        (scrollToEnd)="scrollToEndEvent.emit($event)"
    >
        <!-- Selected Item Template -->
        @if (labelTemp; as item) {
            <ng-template ng-label-tmp let-item="item">
                <ng-template *ngTemplateOutlet="labelTemp; context: {item: item}" />
            </ng-template>
        }

        <!-- Overall Lable For All Selected Items Template -->
        <ng-template *ngIf="multiLabelTemp" ng-multi-label-tmp let-items="items" let-clear="clear">
            <ng-template *ngTemplateOutlet="multiLabelTemp; context: {items: items, clear: clear}" />
        </ng-template>

        <!-- Option Template -->
        <ng-template
            *ngIf="optionTemp"
            ng-option-tmp
            let-item="item"
            let-index="index"
            let-search="searchTerm"
            let-item$="item$"
        >
            <ng-template
                *ngTemplateOutlet="optionTemp; context: {item: item, index: index, searchTerm: search, item$: item$}"
            />
        </ng-template>

        @if (multipleInline && !multiLabelTemp) {
            <ng-template ng-multi-label-tmp let-items="items">
                <div class="ng-value">
                    {{ getMultipleInlineItemsLabels(items) }}
                </div>
            </ng-template>
        }

        <!-- Search Text Templates -->
        <ng-template ng-typetosearch-tmp>
            @if (typeToSearchText) {
                <div class="ng-option disabled">{{ typeToSearchText }}</div>
            }
        </ng-template>
        <ng-template ng-loadingtext-tmp let-searchTerm="searchTerm">
            <div class="ng-option disabled">{{ loadingText }}</div>
        </ng-template>
        <ng-template ng-notfound-tmp let-searchTerm="searchTerm">
            <div class="ng-option disabled">{{ notFoundText }}</div>
        </ng-template>
    </ng-select>

    @if (hasErrors && errorsMessages) {
        <evo-control-error [errors]="control.errors" [errorsMessages]="errorsMessages" />
    }
</div>
